<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>스프라이트 전체 테스트</title>
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: #f0f0f0;
        }

        canvas {
            border: 2px solid #333;
            background-color: #fff;
        }
    </style>
</head>

<body>
    <canvas id="testCanvas"></canvas>
    <script>
        const canvas = document.getElementById('testCanvas');
        const ctx = canvas.getContext('2d');
        const spriteSheet = new Image();
        spriteSheet.src = 'balance.png';

        const allSprites = [
            { id: 1, name: 'walking_0', x: 0, y: 0, width: 80, height: 96 },
            { id: 2, name: 'walking_1', x: 80, y: 0, width: 80, height: 96 },
            { id: 3, name: 'walking_2', x: 160, y: 0, width: 80, height: 96 },
            { id: 4, name: 'jumping_0', x: 240, y: 0, width: 80, height: 96 },
            { id: 5, name: 'jumping_1', x: 480, y: 192, width: 80, height: 96 },
            { id: 6, name: 'jumping_2', x: 480, y: 288, width: 80, height: 96 },
            { id: 7, name: 'jumping_3', x: 320, y: 0, width: 80, height: 96 },
            { id: 8, name: 'falling_left', x: 400, y: 0, width: 80, height: 96 },
            { id: 9, name: 'falling_right', x: 480, y: 0, width: 80, height: 96 },
            { id: 10, name: 'leaning_left_slight_0', x: 0, y: 96, width: 80, height: 96 },
            { id: 11, name: 'leaning_left_slight_1', x: 80, y: 96, width: 80, height: 96 },
            { id: 12, name: 'leaning_left_slight_2', x: 160, y: 96, width: 80, height: 96 },
            { id: 13, name: 'leaning_right_slight_0', x: 240, y: 96, width: 80, height: 96 },
            { id: 14, name: 'leaning_right_slight_1', x: 320, y: 96, width: 80, height: 96 },
            { id: 15, name: 'leaning_right_slight_2', x: 400, y: 96, width: 80, height: 96 },
            { id: 16, name: 'fallen', x: 480, y: 96, width: 80, height: 96 },
            { id: 17, name: 'leaning_left_medium_0', x: 0, y: 192, width: 80, height: 96 },
            { id: 18, name: 'leaning_left_medium_1', x: 80, y: 192, width: 80, height: 96 },
            { id: 19, name: 'leaning_left_medium_2', x: 160, y: 192, width: 80, height: 96 },
            { id: 20, name: 'leaning_right_medium_0', x: 240, y: 192, width: 80, height: 96 },
            { id: 21, name: 'leaning_right_medium_1', x: 320, y: 192, width: 80, height: 96 },
            { id: 22, name: 'leaning_right_medium_2', x: 400, y: 192, width: 80, height: 96 },
            { id: 23, name: 'leaning_left_large_0', x: 0, y: 288, width: 80, height: 96 },
            { id: 24, name: 'leaning_left_large_1', x: 80, y: 288, width: 80, height: 96 },
            { id: 25, name: 'leaning_left_large_2', x: 160, y: 288, width: 80, height: 96 },
            { id: 26, name: 'leaning_right_large_0', x: 240, y: 288, width: 80, height: 96 },
            { id: 27, name: 'leaning_right_large_1', x: 320, y: 288, width: 80, height: 96 },
            { id: 28, name: 'leaning_right_large_2', x: 400, y: 288, width: 80, height: 96 }
        ];

        spriteSheet.onload = () => {
            console.log('스프라이트 시트 로드 완료. 캔버스에 그리기 시작합니다.');
            const spritesPerRow = 7;
            const horizontalGap = 20;
            const verticalGap = 40;
            const spriteWidth = 80;
            const spriteHeight = 96;
            const padding = 20;

            // ✨ 스프라이트 수에 맞춰 캔버스 크기를 동적으로 계산합니다.
            const totalRows = Math.ceil(allSprites.length / spritesPerRow);
            const totalCols = spritesPerRow;

            canvas.width = padding * 2 + (totalCols * spriteWidth) + ((totalCols - 1) * horizontalGap);
            canvas.height = padding * 2 + (totalRows * spriteHeight) + (totalRows * verticalGap) + 15; // 텍스트 공간 고려

            ctx.font = '12px Arial';
            ctx.fillStyle = '#000';
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            allSprites.forEach((sprite, index) => {
                const row = Math.floor(index / spritesPerRow);
                const col = index % spritesPerRow;

                const drawX = padding + col * (spriteWidth + horizontalGap);
                const drawY = padding + row * (spriteHeight + verticalGap);

                ctx.drawImage(
                    spriteSheet,
                    sprite.x,
                    sprite.y,
                    sprite.width,
                    sprite.height,
                    drawX,
                    drawY,
                    sprite.width,
                    sprite.height
                );

                ctx.fillText(`ID: ${sprite.id}`, drawX, drawY + sprite.height + 15);
                ctx.fillText(`${sprite.name}`, drawX, drawY + sprite.height + 30);
            });
        };

        spriteSheet.onerror = () => {
            console.error('스프라이트 시트 로드 실패! 파일 이름과 위치를 확인하세요.');
        };
    </script>
</body>

</html>