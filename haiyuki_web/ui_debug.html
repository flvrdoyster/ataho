<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Credits Scene Debug</title>
    <style>
        body {
            background-color: #333;
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            font-family: sans-serif;
        }

        canvas {
            border: 2px solid #555;
            background-color: black;
            margin-top: 10px;
        }

        .controls {
            margin-top: 10px;
            display: flex;
            gap: 10px;
        }

        button {
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
        }
    </style>
</head>

<body>

    <h1>Credits Scene Debug</h1>
    <div class="controls">
        <button onclick="playCredits('NORMAL')">Play Credits (NORMAL)</button>
        <button onclick="playCredits('TRUE')">Play Credits (TRUE)</button>
    </div>
    <canvas id="gameCanvas" width="640" height="480"></canvas>

    <!-- Scripts -->
    <script src="js/core/assets.js"></script>
    <script src="js/core/input.js"></script>
    <script src="js/core/game.js"></script>
    <script src="js/ui/uiCommon.js"></script>
    <script src="js/data/characterData.js"></script>
    <script src="js/data/battleConfig.js"></script>

    <!-- Scenes -->
    <script src="js/scenes/titleScene.js"></script>
    <script src="js/scenes/creditsScene.js"></script>

    <script>
        // Override Assets toLoad to only load what we need for Credits
        // This prevents getting stuck if other assets are missing
        Assets.toLoad = [
            'ui/alphabet.png'
        ];

        // Mock Game Start
        window.onload = function () {
            console.log("Window Loaded");

            try {
                // Initialize Game Context Manually if Game.init() is too heavy
                const canvas = document.getElementById('gameCanvas');
                Game.canvas = canvas;
                Game.ctx = canvas.getContext('2d');
                Game.width = canvas.width;
                Game.height = canvas.height;
                Game.scenes = {};

                // Assets Load
                Assets.load(() => {
                    console.log("Assets Loaded");
                    document.body.style.backgroundColor = '#222'; // Visual cue
                    // Start directly with Credits Scene (Normal)
                    playCredits('NORMAL');
                });
            } catch (e) {
                console.error(e);
                document.body.innerHTML += `<h3 style="color:red">${e.message}</h3>`;
            }
        };

        function playCredits(type) {
            console.log(`Starting Credits: ${type}`);

            // Mock Game.changeScene behavior simply
            Game.currentScene = CreditsScene;
            CreditsScene.init({ endingType: type });

            // Start Loop
            if (!Game.loopStarted) {
                Game.loopStarted = true;
                loop();
            }
        }

        function loop() {
            requestAnimationFrame(loop);
            if (Game.currentScene) {
                Game.currentScene.update();
                Game.currentScene.draw(Game.ctx);
            }
            Input.update(); // Update input state
        }
    </script>
</body>

</html>